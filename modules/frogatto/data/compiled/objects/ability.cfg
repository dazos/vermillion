{
	"animation": {
		"duration": 6,
		"frames": 6,
		"id": "normal",
		"image": "props/store-items.png",
		"pad": 3,
		"rect": [1,196,17,211],
		"scale": 3
	},
	"collide_dimensions": ["~item"],
	"editor_info": {
		"category": "props",
		"var": [
			{
				"enum_values": "[firebreath,energyshot,homingshot]",
				"name": "kind",
				"type": "enum",
				"value": "'firebreath'"
			}
		]
	},
	"id": "ability",
	"no_compile_image": "props/store-items.png",
	"on_acquire_float": "[set(alpha,255),set(midpoint_x,level.player.mid_x - 16*level.player.facing),set(midpoint_y,level.player.mid_y-60),set(velocity_y,-30),set(accel_y,00),set(zorder,50)]",
	"on_acquired": "[
		set(level.player.control_lock, []),
		set(level.player.velocity_x,0),
		set(level.player.velocity_y,max(0,level.player.velocity_y)),
		schedule(50,set(level.player.animation, 'item_get_begin')),
		set(vars.time_acquired,cycle),
		set(alpha,0),
		
		map(range(21), schedule(value, set(level.music_volume,1-(1.0*value)/20))),
		map(range(21), schedule(180+value, set(level.music_volume, (1.0*value)/20))),
		sound('SpecialItem2.ogg'),
		
		set(level.zoom, 2),
		schedule(40, fire_event('acquire_float')),
		schedule(90, fire_event('force_loot_acquire')),
		schedule(2,level.player.store_event(event_name,1)),
		level.player.add_ability(self.vars.kind),
		schedule(160, set(level.player.animation, 'item_get_end')),
		schedule(200, [set(level.player.control_lock, null),set(level.zoom, 1),]),
		schedule(210, die()),
		schedule(40,description())
	
	]",
	"on_collide_object_item": "if(collide_with.is_player_body_part and vars.time_acquired = 0,[fire_event('acquired')])",
	"on_create": "[ if(level.player.vars.stored_events[event_name] = 1, remove_object(me)),
					add(variations, [vars.kind]),animation('normal'),add_particles('particles')]",
	"on_end_anim": "animation('normal')",
	"on_force_loot_acquire": "[set(alpha,0),do_color_flash(),spawn('silhouette_star.burst',mid_x,mid_y,1),map([0,0,0,0],spawn('coin_sparkle',midpoint_x + 1d40-20,midpoint_y + 1d40-20,0))]",
	"particle_system": {
		"animation": [
			{
				"duration": 6,
				"frame_info": [0,0,0,0,995,1011,11,11,1,1,1,1,1006,1011,9,9,3,3,3,3,1015,1011,5,5,5,5,5,5,1020,1011,1,1],
				"frames": 4,
				"id": "sparkle",
				"image": "compiled-2.png",
				"rect": [995,1011,1005,1021]
			},
			{
				"duration": 4,
				"frame_info": [1,1,1,1,1007,246,9,9,3,3,3,3,1016,246,5,5,5,5,5,5,1021,246,1,1],
				"frames": 3,
				"id": "sparkle",
				"image": "compiled-0.png",
				"rect": [1006,245,1016,255]
			},
			{
				"duration": 6,
				"frame_info": [3,3,3,3,1018,133,5,5,5,5,5,5,1023,133,1,1],
				"frames": 2,
				"id": "sparkle",
				"image": "compiled-1.png",
				"rect": [1015,130,1025,140]
			}
		],
		"id": "particles",
		"max_x": 30,
		"max_y": 30,
		"min_x": -10,
		"min_y": -10,
		"spawn_rate": 10,
		"time_to_live": 18,
		"type": "simple"
	},
	"properties": {
		"description": "def() switch(vars.kind,
					'firebreath', speech_dialog([~You gained a new ability!~],[~You can now breathe out a\\nshort stream of intense flame.~],[~This has very little range, but is quite damaging.~],description_tail),
					'energyshot', speech_dialog([~You gained a new ability!~],[~You can now fire balls of harmful\\nenergy from your fingertips.~],[~This has excellent range,\\nand does decent damage.~],description_tail),
					'homingshot', speech_dialog([~You gained a new ability!~],[~You can now fire balls of harmful\\nenergy from your fingertips,\\nwhich home in on your enemies.~],[~These have excellent range and decent damage,\\nbut are somewhat draining to use.~],description_tail))",
		"description_tail": "[if(IPHONE_SYSTEM,~Tap the upper-left corner of the screen\\nto switch between abilities.~,~Press ${ATTACK_KEY} to switch between abilities.~)]",
		"do_color_flash": "def()		[screen_flash([166,200,255,5],[5,6,0,20],13),
				 				schedule(13,screen_flash([210,255,255,255],[0,0,0,0],2)),
				 				schedule(13+2,screen_flash([166,200,255,255],[5,6,0,-20],5)),
				 				schedule(13+8,screen_flash([166,200,255,155],[5,6,0,20],5)),
				 				schedule(13+13,screen_flash([210,255,255,255],[0,0,0,0],2)),
				 				schedule(13+15,screen_flash([255,255,255,255],[-3,-3,0,-3],250))]
				 				",
		"event_name": "'ability_' + vars.kind + '_acquired'"
	},
	"respawns": false,
	"traction_in_air": 1000,
	"variations": {
		"energyshot": "[map(filter(doc.animation, value.rect = [1,196,17,211]), 'anim', set(anim.rect, [1,145,17,160]))]",
		"firebreath": "null",
		"homingshot": "[map(filter(doc.animation, value.rect = [1,196,17,211]), 'anim', set(anim.rect, [1,213,17,228]))]"
	},
	"vars": {
		"kind": null,
		"time_acquired": 0
	}
}